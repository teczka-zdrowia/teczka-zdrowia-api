webpackJsonp([1],{gkKX:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=e("Xxa5"),i=e.n(n),s=e("exGp"),r=e.n(s),o=e("Dd8w"),c=e.n(o),l=e("G1Gd"),d=e("YVw1"),u=e("0vHE"),p=e("y+U1"),m=e("TiP/"),_=e("mfxR"),f=e("NYxO"),v={name:"AddPatientComponent",data:function(){return{data:{pesel:"",name:"",email:"",phone:"",address:""},loading:{search:!1,initalize:!1},initalizeNew:!1,newAccountCreated:!1}},computed:c()({},Object(f.c)({place:"addPatient/place",patient:"addPatient/patient",searchFailed:"addPatient/searchFailed"}),{isPeselCorrect:function(){if(!/^[0-9]{11}$/.test(this.data.pesel))return!1;var a=[1,3,7,9],t=(""+this.data.pesel).split("").map(function(a){return parseInt(a,10)}),e=t.splice(-1)[0],n=t.reduce(function(t,e,n){return t+e*a[n%4]})%10;return 10-(0===n?10:n)===e}}),methods:c()({},Object(f.b)({searchPatientByPesel:"addPatient/searchByPesel",initalizePatientAccount:"addPatient/initalizePatient",clearData:"addPatient/clear",clearPatient:"addPatient/clearPatient"}),{searchPatient:function(){var a=r()(i.a.mark(function a(){var t=this;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return this.clearPatient(),this.loading.search=!0,a.next=4,this.searchPatientByPesel(this.data.pesel).then(function(){t.$toasted.success("Znaleziono użytkownika")}).catch(function(a){return Object(_.a)(a)});case 4:this.loading.search=!1;case 5:case"end":return a.stop()}},a,this)}));return function(){return a.apply(this,arguments)}}(),initalizePatient:function(){var a=r()(i.a.mark(function a(){var t=this;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return this.loading.initalize=!0,a.next=3,this.initalizePatientAccount(this.data).then(function(){t.newAccountCreated=!0,t.$toasted.success("Użytkownik utworzony pomyślnie"),t.$toasted.success("Dane logowania zostały wysłane na podany email",{duration:1e3})}).catch(function(a){return Object(_.a)(a)});case 3:this.loading.initalize=!1;case 4:case"end":return a.stop()}},a,this)}));return function(){return a.apply(this,arguments)}}()}),watch:{isPeselCorrect:function(a,t){!1===a&&!0===t&&this.clearPatient()}},mounted:function(){this.clearPatient()},components:{MainBtn:d.a,MainInput:u.a,MainPlaceInfo:l.a,MainUserBlockInfo:p.a,GreyBlock:m.a}},h={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"addpatient"},[e("div",{staticClass:"addpatient__place"},[e("span",{staticClass:"addpatient__place__title"},[a._v("\n      Gabinet:\n    ")]),a._v(" "),e("MainPlaceInfo",{staticClass:"addpatient__place__info",attrs:{data:a.place}})],1),a._v(" "),a.initalizeNew?a._e():e("form",{staticClass:"addpatient__form",on:{submit:function(t){return t.preventDefault(),a.searchPatient(t)}}},[e("MainInput",{class:{novalid:!a.isPeselCorrect}},[a._v("\n      PESEL\n      "),e("input",{directives:[{name:"model",rawName:"v-model",value:a.data.pesel,expression:"data.pesel"}],attrs:{type:"text",name:"pesel",minlength:"11",maxlength:"11",placeholder:"12345678912",required:""},domProps:{value:a.data.pesel},on:{input:function(t){t.target.composing||a.$set(a.data,"pesel",t.target.value)}}})]),a._v(" "),a.isPeselCorrect?e("MainBtn",{staticClass:"addpatient__form__btn",attrs:{color:"#fafafa",loading:a.loading.search,disabled:a.loading.search}},[a._v("Wyszukaj pacjenta po PESEL\n    ")]):a._e()],1),a._v(" "),a.isPeselCorrect&&a.searchFailed&&!a.initalizeNew?e("MainBtn",{staticClass:"addpatient__form__btn addpatient__form__btn--red",nativeOn:{click:function(t){a.initalizeNew=!a.initalizeNew}}},[a._v("Utwórz konto użytkownika\n  ")]):a._e(),a._v(" "),a.initalizeNew?e("form",{staticClass:"addpatient__form",on:{submit:function(t){return t.preventDefault(),a.initalizePatient(t)}}},[e("div",[e("MainInput",{staticClass:"many"},[a._v("\n        Imię i nazwisko\n        "),e("input",{directives:[{name:"model",rawName:"v-model",value:a.data.name,expression:"data.name"}],attrs:{name:"name",type:"text",placeholder:"Jan Kowalski",maxlength:"100",required:""},domProps:{value:a.data.name},on:{input:function(t){t.target.composing||a.$set(a.data,"name",t.target.value)}}})]),a._v(" "),e("MainInput",{staticClass:"many"},[a._v("\n        E-mail\n        "),e("input",{directives:[{name:"model",rawName:"v-model",value:a.data.email,expression:"data.email"}],attrs:{type:"email",name:"email",placeholder:"jan@kowalski.com",minlength:"4",maxlength:"100",required:""},domProps:{value:a.data.email},on:{input:function(t){t.target.composing||a.$set(a.data,"email",t.target.value)}}})]),a._v(" "),e("MainInput",{staticClass:"many"},[a._v("\n        Telefon\n        "),e("input",{directives:[{name:"model",rawName:"v-model",value:a.data.phone,expression:"data.phone"}],attrs:{type:"tel",name:"phone",placeholder:"123654789",minlength:"9",maxlength:"15",required:""},domProps:{value:a.data.phone},on:{input:function(t){t.target.composing||a.$set(a.data,"phone",t.target.value)}}})]),a._v(" "),e("MainInput",{staticClass:"many"},[a._v("\n        Adres\n        "),e("input",{directives:[{name:"model",rawName:"v-model",value:a.data.address,expression:"data.address"}],attrs:{type:"text",name:"address",placeholder:"Kwiatowa 4, Warszawa",maxlength:"100",required:""},domProps:{value:a.data.address},on:{input:function(t){t.target.composing||a.$set(a.data,"address",t.target.value)}}})])],1),a._v(" "),e("MainBtn",{staticClass:"addpatient__form__btn",attrs:{color:"#fafafa",loading:a.loading.initalize,disabled:a.loading.initalize}},[a._v("Utwórz konto\n    ")])],1):a._e(),a._v(" "),a.newAccountCreated?e("GreyBlock",{staticClass:"addpatient__info"},[a._v("Utworzono nowe konto użytkownika. Dane logowania zostały wysłane na\n    podany wcześniej adres e-mail.\n  ")]):a._e(),a._v(" "),a.patient?e("MainUserBlockInfo",{staticClass:"addpatient__patient",attrs:{user:a.patient}}):a._e()],1)},staticRenderFns:[]};var P=e("VU/8")(v,h,!1,function(a){e("vc9u")},"data-v-f0060cda",null).exports,g=(e("8M/P"),{name:"AddPatient",components:{AddPatientComponent:P,MainBtn:d.a},data:function(){return{isLoading:!1}},computed:c()({},Object(f.c)({data:"modal/data",processCompleted:"addPatient/isCompleted",patient:"addPatient/patient",place:"addPatient/place"})),methods:c()({},Object(f.b)({modalVisible:"modal/visible",hideModal:"modal/hide",createPlacePatientRole:"placePatients/createRole",clearData:"addPatient/clear"}),{createPatient:function(){var a=r()(i.a.mark(function a(){var t,e=this;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:this.isLoading=!0,t={userId:this.patient.id,placeId:this.place.id},this.createPlacePatientRole(t).then(function(){e.$toasted.success("Poprawnie dodano pacjenta"),e.hideModal()}).catch(function(a){return Object(_.a)(a)}).finally(function(){e.isLoading=!1});case 3:case"end":return a.stop()}},a,this)}));return function(){return a.apply(this,arguments)}}()}),mounted:function(){this.clearData()}}),w={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("form",{staticClass:"modal--cp",on:{submit:function(t){return t.preventDefault(),a.createPatient(t)}}},[e("AddPatientComponent"),a._v(" "),e("div",{staticClass:"modal__actions"},[e("button",{staticClass:"modal__btn modal__btn--grey",attrs:{type:"button"},on:{click:a.hideModal}},[a._v("Anuluj\n    ")]),a._v(" "),a.processCompleted?e("MainBtn",{staticClass:"modal__btn modal__btn--violet",attrs:{loading:a.isLoading,disabled:a.isLoading,color:"#fafafa"},nativeOn:{click:function(t){return a.createPatient(t)}}},[a._v("Dodaj pacjenta\n    ")]):a._e()],1)],1)},staticRenderFns:[]};var y=e("VU/8")(g,w,!1,function(a){e("yaCi")},"data-v-024b4884",null);t.default=y.exports},siq4:function(a,t){},vc9u:function(a,t){},"y+U1":function(a,t,e){"use strict";var n=e("ctaT"),i=e("PJh5");i.locale("pl");var s={name:"MainUserBlockInfo",props:{user:{type:Object,default:function(){return{avatar:"avatar.png",name:"Brak danych",email:"Brak danych",phone:"Brak danych",birthdate:null}}}},data:function(){return{apiUrl:n.a}},computed:{userAge:function(){return this.userBirthdate?Math.abs(i(this.userBirthdate,"DD.MM.YYYY").diff(i(),"years")):"brak"},userBirthdate:function(){return this.user.birthdate?i(this.user.birthdate,"YYYY-MM-DD HH:MI:SS").format("DD.MM.YYYY"):null}}},r={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"user"},[e("div",{staticClass:"user__img"},[e("img",{attrs:{src:a.user.avatar?a.apiUrl+"/storage/avatars/"+a.user.avatar:"/static/img/icons/avatar.png",alt:a.user.name}})]),a._v(" "),e("div",{staticClass:"user__info"},[e("div",{staticClass:"user__info__name"},[a._v("\n      "+a._s(a.user.name)+" ("+a._s(a.userAge)+" lat)\n    ")]),a._v(" "),e("a",{staticClass:"user__info__phone",attrs:{href:"tel:"+a.user.phone}},[e("span",{staticClass:"fas fa-phone",attrs:{"aria-hidden":"true"}}),a._v("\n      "+a._s(a.user.phone)+"\n    ")]),a._v(" "),e("a",{staticClass:"user__info__email",attrs:{href:"mailto:"+a.user.email}},[e("span",{staticClass:"fas fa-envelope",attrs:{"aria-hidden":"true"}}),a._v("\n      "+a._s(a.user.email)+"\n    ")])])])},staticRenderFns:[]};var o=e("VU/8")(s,r,!1,function(a){e("siq4")},"data-v-4c960ebe",null);t.a=o.exports},yaCi:function(a,t){}});
//# sourceMappingURL=1.6f282785019b0e30f684.js.map